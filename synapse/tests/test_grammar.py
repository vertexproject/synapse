import synapse.lib.syntax2 as s_syntax2

import synapse.tests.utils as s_t_utils
import lark

_Queries = [
    '',
    '#foo',
    'help',
    'refs',
    '#$tag',
    'wentto',
    '[-#foo]',
    'syn:tag',
    'teststr',
    '.created',
    '##baz.faz',
    'inet:fqdn',
    'inet:user',
    '#test.baz',
    '#hehe.haha',
    'inet:dns:a',
    'testint<20',
    'testint>20',
    'testint<30',
    'testint>30',
    'testint <=20',
    'testint>=20',
    'testint<=30',
    'teststr=foo',
    'teststr#foo',
    'pivcomp=$foo',
    'testint=1234',
    '[testint=20]',
    'teststr=$foo',
    'teststr=ohmy',
    '.created<2010',
    '.created>2010',
    'iden deadb33f',
    'testcomp -> *',
    'testint:loc=u',
    '[ testint=42 ]',
    'testint:loc=""',
    'testint:loc^=u',
    'testint:loc=us',
    'teststr~="zip"',
    '.created="2001"',
    '.seen~="^r"',
    'testint=8675309',
    '[testint=99999]',
    'testint:loc^=""',
    'testint:loc^=23',
    'testint +:loc=u',
    'testint:loc^=us',
    'teststr [-#foo]',
    'teststr#foo.bar',
    '[teststr=hello]',
    '.seen [ -.seen ]',
    'inet:ipv4:loc=us',
    'inet:ipv4:loc=zz',
    '#$tag [ -#$tag ]',
    'testint +:loc=""',
    'testint +:loc^=u',
    'testint +:loc=us',
    'testint:loc^=us.',
    'testint:loc=us.v',
    'teststr=bar <- *',
    '[ teststr=hehe ]',
    'teststr %limit=1',
    'teststr [-:tick]',
    'file:bytes:size=4',
    'movetag #a.b #a.m',
    'pivcomp:tick=$foo',
    'syn:tag=a.b +#foo',
    'testint +:loc^=""',
    'testint +:loc^=23',
    'testint +:loc^=us',
    'testint:loc^=us.v',
    'testint:loc=us.va',
    'teststr=bar <+- *',
    'teststr#foo@=2016',
    'teststr:tick=2015',
    'inet:fqdn=woot.com',
    '[ inet:ipv4=$foo ]',
    'pivcomp | noderefs',
    'pivcomp -> testint',
    'testint=3735928559',
    'testint +:loc^=us.',
    'testint +:loc=us.v',
    'testint:loc^=us.va',
    'teststr=foo <- has',
    'teststr=visi -> #*',
    'inet:user | limit 1',
    'movetag #hehe #woot',
    'pivcomp=(hehe,haha)',
    'testcomp -> testint',
    'testguid | max tick',
    'testguid | min tick',
    '[testint=3 :loc=""]',
    'testint +:loc^=us.v',
    'testint +:loc=us.va',
    'testint:loc^=us.va.',
    'testint +testint>10',
    'testint +testint<30',
    'teststr +#foo@=2016',
    'teststr [+#foo.bar]',
    'teststr=foo <+- has',
    'teststr +:tick=2015',
    '.created="{created}"',
    'inet:ipv4 -> teststr',
    'inet:user | limit 1|',
    '[pivcomp=(foo, 123)]',
    'syn:tag=foo.bar -> *',
    '[testint=12 :loc=us]',
    'testint +:loc^=us.va',
    'testint:loc=us.va.sy',
    'testint +testint>=10',
    'testint +testint<=30',
    'inet:dns:a :ipv4 -> *',
    'inet:ipv4=10.2.1.1/28',
    '[ inet:ipv4=1.2.3.4 ]',
    '[ pivcomp=(foo,bar) ]',
    'reindex --form-counts',
    '#test.bar -#test <- *',
    '#test.bar -#test -> *',
    'testint +:loc^=us.va.',
    '[ teststr=bar +#baz ]',
    '[ teststr=foo +#bar ]',
    'teststr=foo | delnode',
    'pivcomp=(foo,bar) -> *',
    'seen:source=$sorc -> *',
    'sudo | [ teststr=foo ]',
    '#test.bar -#test <+- *',
    '#test.bar -#test -+> *',
    'testcomp:haha~="^lulz"',
    'testcomp:haha~="^zerg"',
    'testint=123 | noderefs',
    'testint +:loc=us.va.sy',
    'teststr=123 | noderefs',
    'teststr=foobar -+> has',
    '[ teststr=foo +#$tag ]',
    '[ teststr=haha +#foo ]',
    'teststr +:tick@=(2015)',
    'teststr=visi -> #baz.*',
    'teststr=visi -> #foo.*',
    'pivcomp=(foo,bar) -+> *',
    'sudo | [ testguid="*" ]',
    '#test.bar +pivcomp -> *',
    '#test.bar +teststr <- *',
    '[testcomp=(1234, 5678)]',
    '[testint=10 :loc=us.va]',
    'testint:loc^=us.va.fair',
    'testint:loc=us.va.syria',
    'teststr=foo +#lol@=2014',
    'teststr=foo +#lol@=2016',
    'teststr | noderefs -d 3',
    '[ inet:fqdn = woot.com ]',
    'inet:ipv4=192.168.1.0/24',
    'inet:user | limit --woot',
    '#test.bar +pivcomp -+> *',
    '#test.bar +teststr <+- *',
    'testint:loc=us.va.sydney',
    'teststr#foo@=(2012,2022)',
    'inet:ipv4=1.2.3.1-1.2.3.3',
    'pivcomp | noderefs --join',
    '[testguid="*" :tick=2001]',
    'testint +:loc^=us.va.fair',
    'teststr | delnode --force',
    'teststr:tick<201808021202',
    'teststr:tick>201808021202',
    '[ teststr=woot .seen=20 ]',
    'teststr=woot +.seen@=2012',
    'teststr=woot +.seen@=2015',  # delete
    'teststr=woot +.seen@=#bar',
    'teststr=woot +.seen@=#baz',  # delete
    'inet:ipv4=1.2.3.4|limit 20',
    'inet:ipv4 +:asn::name=visi',
    'inet:ipv4 | reindex --subs',
    'sudo | testint=6 | delnode',
    'syn:tag=aaa.barbarella.ddd',
    'syn:tag=foo.bar -> teststr',
    '[testguid=abcd :tick=2015]',
    'testint=123 | noderefs -te',
    '[testint=9 :loc=us.à¤“à¤‚]',
    'testint:loc^=us.va.fairfax',
    'testint +:loc=us.va.sydney',
    'teststr="foo bar" +teststr',
    'teststr | noderefs -d 3 -u',
    'teststr +:tick@=("-1 day")',
    'teststr:tick<=201808021202',
    'teststr:tick>=201808021202',
    '.created*range=(2010, 3001)',
    '[ inet:asn=200 :name=visi ]',
    '[ inet:fqdn=woot.com ] -> *',
    '[inet:ipv4=1.2.3.1-1.2.3.3]',
    '[ inet:ipv4=192.168.1.0/24]',
    'pivtarg=hehe [ .seen=2015 ]',
    'ps:person=$pers -> has -> *',
    '[ testguid="*" :tick=2015 ]',
    '[ testguid="*" :tick=2016 ]',
    '[ testguid="*" :tick=2017 ]',
    'testint:loc^=us.va.fairfax.',
    'teststr=bar -> pivcomp:lulz',
    '[teststr=beep teststr=boop]',
    'teststr +#foo@=(2014, 2019)',
    'teststr +#foo@=(2015, 2018)',
    '[ teststr=foo teststr=bar ]',
    '[ teststr=haha +#bar=2015 ]',
    '[ teststr=haha +#bar=2016 ]',
    '.created*range=("2010", "?")',
    'geo:place=$place <- has <- *',
    'inet:fqdn=woot.com | delnode',
    'pivcomp=(foo,bar) -> pivtarg',
    'seen:source=$sorc :node -> *',
    'sudo | [ inet:ipv4=1.2.3.4 ]',
    'sudo | [ teststr=foo +#lol ]',
    'testcomp -> * | uniq | count',
    '[testint=1 :loc=us.va.syria]',
    'testint +:loc^=us.va.fairfax',
    'testint +:loc="us.va. syria"',
    'teststr=bar -+> pivcomp:lulz',
    'teststr="foo bar" [ -:tick ]',
    'teststr=hello [:tick="2001"]',
    'teststr=hello [:tick="2002"]',
    '[ inet:ipv4=1.2.3.4 :asn=20 ]',
    'inet:user | limit 1    |     ',
    'pivcomp=(foo,bar) -+> pivtarg',
    'syn:tag=baz.faz [ +#foo.bar ]',
    '[testint=2 :loc=us.va.sydney]',
    'testint +:loc^=us.va.fairfax.',
    '[ inet:ipv4=1.2.3.4 :asn=200 ]',
    'movetag #aaa.b #aaa.barbarella',
    'pivcomp | noderefs --join -d 3',
    'ps:person=$pers -> wentto -> *',
    '[testint=4 :loc=us.va.fairfax]',
    '$bar=5.5.5.5 [ inet:ipv4=$bar ]',
    '[ inet:dns:a=$blob.split("|") ]',
    'inet:ipv4 -inet:ipv4=1.2.3.0/30',
    'inet:ipv4 +inet:ipv4=1.2.3.0/30',
    '[ pivcomp=(xxx,yyy) :width=42 ]',
    'sudo | [teststr=123 :tick=2018]',
    'syn:tag=foo.bar -> teststr:tick',
    '[testint=1 testint=2 testint=3]',
    '[testint=8 :loc=us.ca.sandiego]',
    'teststr +#foo@=(2014, 20141231)',
    'teststr [+#foo.bar=(2000,2002)]',
    'teststr="foo bar" -teststr:tick',
    '[ teststr="foo bar" :tick=2018]',
    'teststr +:tick=(2015, "+1 day")',
    'teststr +:tick@=(now, "-1 day")',
    '[ teststr=visi +#foo.bar ] -> #',
    'inet:fqdn=woot.com -> inet:dns:a',
    'inet:ipv4 +inet:ipv4=10.2.1.4/31',
    'inet:ipv4 +inet:ipv4=10.2.1.4/32',
    '[ pivcomp=(foo,bar) :tick=2018 ]',
    'teststr=foobar -> has <- teststr',
    '[teststr=foo :tick=201808021201]',
    'teststr | noderefs -d 3 --unique',
    'teststr +:tick@=(2015, "+1 day")',
    'teststr=woot +.seen@=(2012,2013)',
    'teststr=woot +.seen@=(2012,2015)',
    '[ inet:dns:a=(woot.com,1.2.3.4) ]',
    'pivcomp | noderefs -j --degrees 2',
    'sudo | [ cycle0=foo :cycle1=bar ]',
    'sudo | [ cycle1=bar :cycle0=foo ]',
    'testcomp +(:hehe<2 or :haha=foob)',
    'testcomp +(:hehe<2 or :haha=test)',
    'testcomp +(:hehe<2 or #meep.gorp)',
    'testint:loc^=us.va.fairfax.reston',
    "[ teststr=abcd :tick=2015 +#cool ]"
    'teststr=foobar -> has <+- teststr',
    'teststr=pennywise | noderefs -d 3',
    'teststr +:tick@=("now-1day", "?")',
    'teststr +:tick=($test, "+- 2day")',
    'pivcomp=(foo,bar) :lulz -> teststr',
    'pivcomp=(foo,bar) :targ -> pivtarg',
    'ps:person=$pers -> wentto :n2 -> *',
    'testcomp +(:hehe<2 and :haha=foob)',
    'testcomp +(:hehe<2 and :haha=test)',
    '[ teststr=foo +#bar ] +(not .seen)',
    '[ teststr=foo teststr=bar ] | spin',
    '[ teststr=hehe +#foo=(2014,2016) ]',
    '[teststr=hehe] | iden abcd | count',
    'teststr +teststr:tick<201808021202',
    'teststr +teststr:tick>201808021202',
    'teststr:tick=(20131231, "+2 days")',
    '[ teststr=woot +#foo=(2015,2018) ]',
    '[ teststr=woot .seen=(2014,2015) ]',
    'cluster=abcd | noderefs -d 2 --join',
    'pivcomp=(foo,bar) :lulz -+> teststr',
    'ps:person=$pers -> has -> geo:place',
    'ps:person=$pers -> has -> inet:ipv4',
    '[seen=(abcd, (teststr, pennywise))]',
    'testint +:loc^=us.va.fairfax.reston',
    'teststr [+#foo.bar=(2000,20020601)]',
    'teststr +teststr:tick<=201808021202',
    'teststr +teststr:tick>=201808021202',
    'teststr +:tick=(20150102, "-3 day")',
    'teststr +:tick=(20150201, "+1 day")',
    'teststr=woot $foo=#foo +.seen@=$foo',
    'geo:place:latlong*near=((0, 0), 50m)',
    'geo:place=$place <- has <- inet:ipv4',
    'geo:place=$place <- has <- ps:person',
    'inet:ipv4 +inet:ipv4=1.2.3.1-1.2.3.3',
    'inet:user | limit 10 | [ +#foo.bar ]',
    '[ inet:user=visi inet:user=whippit ]',
    'testint:loc^=us.va.fairfax.chantilly',
    'teststr +:tick=(20150102, "+- 2day")',
    'teststr +:tick@=(20150102, "-4 day")',
    'iden 2cdd997872b10a65407ad5fadfa28e0d',
    'pivcomp | noderefs --join --degrees 2',
    'testguid +testguid*range=(abcd, dcbe)',
    '[testint=5 :loc=us.va.fairfax.reston]',
    '[ teststr=visi testint=20 +#foo.bar ]',
    'inet:user | limit 10 | +inet:user=visi',
    'ps:person=$pers -> wentto -> inet:ipv4',
    '[testint=7 :loc=us.va.fairfax.herndon]',
    'testint +:loc^=us.va.fairfax.chantilly',
    'teststr=123 | noderefs --traverse-edge',
    '[ teststr=foo teststr=bar ] | sleep 10',
    '[ teststr=foo teststr=bar testint=42 ]',
    '[inet:dns:query=(tcp://1.2.3.4, "", 1)]',
    '[ inet:ipv4 = 94.75.194.194 :loc = nl ]',
    '[refs=((teststr, 123), (testint, 123))]',
    'source=8f1401de15918358d5247e21ca29a814',
    'testcomp +:haha*range=(grinch, meanone)',
    'teststr=123 [:baz="testguid:tick=2015"]',
    'teststr +:tick@=("now+2days", "-3 day")',
    '[ geo:place="*" :latlong=(-30.0,20.22) ]',
    '[ inet:fqdn=woot.com +#bad=(2015,2016) ]',
    'teststr=1234 teststr=duck teststr=knight',
    'teststr=pennywise | noderefs --join -d 9',
    '[has=((teststr, foobar), (teststr, foo))]',
    'inet:dns:a=(woot.com,1.2.3.4) $newp=.seen',
    '[ inet:dns:a=(woot.com, 1.2.3.4) +#yepr ]',
    '[ teststr=foo +#bar ] { [ +#baz ] -#bar }',
    'teststr +:tick@=(20150102+1day, "-4 day")',
    'teststr +:tick*range=(19701125, 20151212)',
    '[ inet:ipv4=1.2.3.0/30 inet:ipv4=5.5.5.5 ]',
    'teststr=bar pivcomp=(foo,bar) [+#test.bar]',
    '[ teststr=foo +#bar ] +(#baz or not .seen)',
    'teststr=pennywise | noderefs -d 3 -ot=omit',
    'for $fqdn in $fqdns { [ inet:fqdn=$fqdn ] }',
    'inet:dns:a -{ :ipv4 -> inet:ipv4 -:loc=us }',
    'inet:dns:a -{ :ipv4 -> inet:ipv4 +:loc=us }',
    'inet:dns:a +{ :ipv4 -> inet:ipv4 -:loc=us }',
    'inet:dns:a +{ :ipv4 -> inet:ipv4 +:loc=us }',
    '[ inet:dns:a = ( woot.com , 12.34.56.78 ) ]',
    '[ inet:fqdn=vertex.link inet:ipv4=1.2.3.4 ]',
    'inet:ipv4=1.2.3.4 +( { -> inet:dns:a }<=1 )',
    'inet:ipv4=1.2.3.4 +( { -> inet:dns:a }>=3 )',
    '[ testcomp=(10, haha) +#foo.bar -#foo.bar ]',
    'teststr=a +:tick*range=(20000101, 20101201)',
    '[ inet:dns:a=(vertex.link, 5.5.5.5) +#nope ]',
    '[ testcomp=(127,newp) ] [testcomp=(127,127)]',
    '[testint=6 :loc=us.va.fairfax.restonheights]',
    '[teststr=a] switch $woot { hehe: {[+#baz]} }',
    'teststr=pennywise | noderefs -d 3 -of=source',
    'geo:place:latlong*near=((34.1, -118.3), 10km)',
    'inet:dns:a +{ :ipv4 -> inet:ipv4 -:asn=1234 }',
    'inet:dns:a +{ :ipv4 -> inet:ipv4 +:asn=1234 }',
    'inet:fqdn=woot.com -> inet:dns:a -> inet:ipv4',
    'pivcomp=(foo,bar) -{ :lulz -> teststr +#baz }',
    'teststr=pennywise | noderefs -d 3 -otf=source',
    '[ teststr=visi +#foo.bar ] -> # [ +#baz.faz ]',
    'geo:place -:latlong*near=((34.1, -118.3), 50m)',
    'inet:asn=10 | noderefs -of inet:ipv4 --join -d 3',
    'teststr +:bar*range=((teststr, c), (teststr, q))',
    '[ teststr=oof +#bar ] { [ testint=0xdeadbeef ] }',
    'inet:ipv4=12.34.56.78 [ :loc = us.oh.wilmington ]',
    'teststr=pennywise | noderefs -d 3 --omit-tag=omit',
    '[ inet:dns:a=(woot.com,1.2.3.4) .seen=(2015,2016) ]',
    'inet:dns:a=(woot.com,1.2.3.4) [ .seen=(2015,2018) ]',
    '[inet:dns:query=(tcp://1.2.3.4, "foo*.haha.com", 1)]',
    '[ pivcomp=(hehe,haha) :tick=2015 +#foo=(2014,2016) ]',
    '[refs=((testint, 16), (testcomp, (9999, greenham)))]',
    'teststr=pennywise | noderefs -d 3 --omit-form=source',
    '[ teststr=woot +#foo=(2015,2018) .seen=(2014,2016) ]',
    '[testcomp=(3, foob) +#meep.gorp +#bleep.zlorp +#cond]',
    'inet:dns:a=(woot.com,1.2.3.4) $hehe=:fqdn -:fqdn=$hehe',
    'inet:dns:a=(woot.com,1.2.3.4) $hehe=:fqdn +:fqdn=$hehe',
    'pivcomp=(foo,bar) +{ :lulz -> teststr +#baz } +pivcomp',
    'geo:place +geo:place:latlong*near=((34.1, -118.3), 10km)',
    'inet:dns:query=(tcp://1.2.3.4, "", 1) :name -> inet:fqdn',
    '[source=abcd +#omit.nopiv] [seen=(abcd, (pivtarg, foo))]',
    'teststr=pennywise | noderefs --join -d 9 --traverse-edge',
    'inet:dns:a=(woot.com,1.2.3.4) $hehe=:fqdn inet:fqdn=$hehe',
    '[inet:ipv4=1.2.3.4 :asn=10] [seen=(abcd, (inet:asn, 10))]',
    '[teststr=c] switch $woot { hehe: {[+#baz]} *: {[+#jaz]} }',
    'geo:place:latlong*near=(("34.118560", "-118.300370"), 50m)',
    'ps:person=$pers -> wentto +:time@=(2014,2017) -> geo:place',
    '[ teststr=woot +#foo=(2015,2018) +#bar .seen=(2014,2016) ]',
    'teststr=pennywise | noderefs -d 3 -ott=omit.nopiv -ott=test',
    'for ($fqdn, $ipv4) in $dnsa { [ inet:dns:a=($fqdn,$ipv4) ] }',
    'geo:place:latlong*near=(("34.118560", "-118.300370"), 2600m)',
    'testcomp +testcomp*range=((1024, grinch), (4096, zemeanone))',
    '[ inet:ipv4=1.2.3.4 :loc=us inet:dns:a=(vertex.link,1.2.3.4) ]',
    '[ inet:ipv4=4.3.2.1 :loc=zz inet:dns:a=(example.com,4.3.2.1) ]',
    'teststr=pennywise | noderefs -d 3 --omit-traversal-form=source',
    'pivcomp=(hehe,haha) $ticktock=#foo -> pivtarg +.seen@=$ticktock',
    "[testcomp=(123, test) testcomp=(123, duck) testcomp=(123, mode)]"
    'for ($fqdn,$ipv4,$boom) in $dnsa { [ inet:dns:a=($fqdn,$ipv4) ] }',
    'inet:fqdn +#bad $fqdnbad=#bad -> inet:dns:a:fqdn +.seen@=$fqdnbad',
    'media:news = 00a1f0d928e25729b9e86e2d08c127ce [ :summary = \"\" ]',
    '[refs=((testcomp, (2048, horton)), (testcomp, (4096, whoville)))]',
    'teststr +:.seen*range=((20090601, 20090701), (20110905, 20110906,))',
    '[ inet:dns:a=(woot.com, 1.2.3.4) inet:dns:a=(vertex.link, 1.2.3.4) ]',
    'refs +:n1*range=((testcomp, (1000, green)), (testcomp, (3000, ham)))',
    'inet:dns:query=(tcp://1.2.3.4, "foo*.haha.com", 1) :name -> inet:fqdn',
    'inet:dns:a = (woot.com,  12.34.56.78) [ .seen=( 201708010123, \"?\" ) ]',
    'testint | noderefs | +testcomp*range=((1000, grinch), (4000, whoville))',
    '[refs=((testcomp, (9001, "A mean one")), (testcomp, (40000, greeneggs)))]',
    'inet:dns:a=(woot.com,1.2.3.4) $seen=.seen :fqdn -> inet:fqdn [ .seen=$seen ]',
    '[ inet:fqdn=woot.com inet:fqdn=vertex.link ] [ inet:user = :zone ] +inet:user',
    'inet:dns:a = (woot.com,  12.34.56.78) [ .seen=( 201708010123, 201708100456 ) ]',
    '[teststr=c] switch $woot { hehe: {[+#baz]} haha hoho: {[+#faz]} "lolz:lulz": {[+#jaz]} }',
    '[ inet:fqdn = hehe.com inet:ipv4 = 127.0.0.1 hash:md5 = d41d8cd98f00b204e9800998ecf8427e]',
    'teststr=pennywise | noderefs -d 3 --omit-traversal-tag=omit.nopiv --omit-traversal-tag=test',
    'geo:place=abcd $latlong=:latlong $radius=:radius | spin | tel:mob:telem:latlong*near=($latlong, 3km)',
    'inet:ipv4=12.34.56.78 inet:fqdn=woot.com [ inet:ipv4=1.2.3.4 :asn=10101 inet:fqdn=woowoo.com +#my.tag ]',
    '''
        for $foo in $foos {

            ($fqdn, $ipv4) = $foo.split("|")

            [ inet:dns:a=($fqdn, $ipv4) ]
        } ''',
    ''' /* A comment */ testint ''',
    ''' testint // a comment''',
    '''/* multi
         line */ testint ''',
    '''
        /* A
            multiline
            comment */
        [ inet:ipv4=1.2.3.4 ] // this is a comment
        // and this too...

        switch $foo {

            // The bar case...

            bar: {
                [ +#hehe.haha ]
            }

            /*
                The
                baz
                case
            */
            baz faz: {}
        } ''',
    '''
        inet:fqdn | graph
                    --degrees 2
                    --filter { -#nope }
                    --pivot { <- seen <- source }
                    --form-pivot inet:fqdn {<- * | limit 20}
                    --form-pivot inet:fqdn {-> * | limit 20}
                    --form-filter inet:fqdn {-inet:fqdn:issuffix=1}
                    --form-pivot syn:tag {-> *}
                    --form-pivot * {-> #} ''',
    '''
        for $foo in $foos {

            [ inet:ipv4=1.2.3.4 ]

            switch $foo {
                bar: { [ +#ohai ] break }
                baz: { [ +#visi ] continue }
            }

            [ inet:ipv4=5.6.7.8 ]
            [ +#hehe ]
        } ''',
    'testint=1234 [teststr=$node.value()] -testint',
    'testint=1234 [teststr=$node.form()] -testint',
    '''
        for $foo in $foos {

            ($fqdn, $ipv4) = $foo.split("|")

            [ inet:dns:a=($fqdn, $ipv4) ]
        } ''',
    ' [ testint=$hehe.haha ] ',
    '($tick, $tock) = .seen',
    '''
    for $tag in $node.tags() {
        -> testint [ +#$tag ]
    } ''',
    '''
    for $tag in $node.tags(fo*) {
        -> testint [ -#$tag ]
    }
    ''',
]

# Generated with gen_parse_list below
_ParseResults = [
    'Query: []',
    'Query: [LiftTag: [TagName: foo, kids=[]]]',
    'Query: [CmdOper: [Const: help, kids=[], Const: (), kids=[]]]',
    'Query: [LiftProp: [Const: refs, kids=[]]]',
    'Query: [LiftTag: [VarValue: [Const: tag, kids=[]]]]',
    'Query: [LiftProp: [Const: wentto, kids=[]]]',
    'Query: [EditTagDel: [TagName: foo, kids=[]]]',
    'Query: [LiftProp: [Const: syn:tag, kids=[]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]]]',
    'Query: [LiftProp: [Const: .created, kids=[]]]',
    'Query: [LiftTagTag: [TagName: baz.faz, kids=[]]]',
    'Query: [LiftProp: [Const: inet:fqdn, kids=[]]]',
    'Query: [LiftProp: [Const: inet:user, kids=[]]]',
    'Query: [LiftTag: [TagName: test.baz, kids=[]]]',
    'Query: [LiftTag: [TagName: hehe.haha, kids=[]]]',
    'Query: [LiftProp: [Const: inet:dns:a, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint, kids=[], Const: <, kids=[], Const: 20, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint, kids=[], Const: >, kids=[], Const: 20, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint, kids=[], Const: <, kids=[], Const: 30, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint, kids=[], Const: >, kids=[], Const: 30, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint, kids=[], Const: <=, kids=[], Const: 20, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint, kids=[], Const: >=, kids=[], Const: 20, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint, kids=[], Const: <=, kids=[], Const: 30, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: foo, kids=[]]]',
    'Query: [LiftFormTag: [Const: teststr, kids=[], TagName: foo, kids=[]]]',
    'Query: [LiftPropBy: [Const: pivcomp, kids=[], Const: =, kids=[], VarValue: [Const: foo, kids=[]]]]',
    'Query: [LiftPropBy: [Const: testint, kids=[], Const: =, kids=[], Const: 1234, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 20, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], VarValue: [Const: foo, kids=[]]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: ohmy, kids=[]]]',
    'Query: [LiftPropBy: [Const: .created, kids=[], Const: <, kids=[], Const: 2010, kids=[]]]',
    'Query: [LiftPropBy: [Const: .created, kids=[], Const: >, kids=[], Const: 2010, kids=[]]]',
    "Query: [CmdOper: [Const: iden, kids=[], Const: ('deadb33f',), kids=[]]]",
    'Query: [LiftProp: [Const: testcomp, kids=[]], PivotOut: [], isjoin=False]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: =, kids=[], Const: u, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 42, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: =, kids=[], Const: , kids=[]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: ^=, kids=[], Const: u, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: =, kids=[], Const: us, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: ~=, kids=[], Const: zip, kids=[]]]',
    'Query: [LiftPropBy: [Const: .created, kids=[], Const: =, kids=[], Const: 2001, kids=[]]]',
    'Query: [LiftPropBy: [Const: .seen, kids=[], Const: ~=, kids=[], Const: ^r, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint, kids=[], Const: =, kids=[], Const: 8675309, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 99999, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: ^=, kids=[], Const: , kids=[]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: ^=, kids=[], Const: 23, kids=[]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: =, kids=[], Const: u, kids=[]]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: ^=, kids=[], Const: us, kids=[]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], EditTagDel: [TagName: foo, kids=[]]]',
    'Query: [LiftFormTag: [Const: teststr, kids=[], TagName: foo.bar, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: hello, kids=[]]]',
    'Query: [LiftProp: [Const: .seen, kids=[]], EditUnivDel: [UnivProp: .seen, kids=[]]]',
    'Query: [LiftPropBy: [Const: inet:ipv4:loc, kids=[], Const: =, kids=[], Const: us, kids=[]]]',
    'Query: [LiftPropBy: [Const: inet:ipv4:loc, kids=[], Const: =, kids=[], Const: zz, kids=[]]]',
    'Query: [LiftTag: [VarValue: [Const: tag, kids=[]]], EditTagDel: [VarValue: [Const: tag, kids=[]]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: =, kids=[], Const: , kids=[]]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: ^=, kids=[], Const: u, kids=[]]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: =, kids=[], Const: us, kids=[]]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: ^=, kids=[], Const: us., kids=[]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: =, kids=[], Const: us.v, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: bar, kids=[]], PivotIn: [], isjoin=False]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: hehe, kids=[]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], EditPropDel: [RelProp: tick, kids=[]]]',
    'Query: [LiftPropBy: [Const: file:bytes:size, kids=[], Const: =, kids=[], Const: 4, kids=[]]]',
    "Query: [CmdOper: [Const: movetag, kids=[], Const: ('#a.b', '#a.m'), kids=[]]]",
    'Query: [LiftPropBy: [Const: pivcomp:tick, kids=[], Const: =, kids=[], VarValue: [Const: foo, kids=[]]]]',
    'Query: [LiftPropBy: [Const: syn:tag, kids=[], Const: =, kids=[], Const: a.b, kids=[]], FiltOper: [Const: +, kids=[], TagCond: [TagName: foo, kids=[]]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: ^=, kids=[], Const: , kids=[]]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: ^=, kids=[], Const: 23, kids=[]]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: ^=, kids=[], Const: us, kids=[]]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: ^=, kids=[], Const: us.v, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: =, kids=[], Const: us.va, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: bar, kids=[]], PivotIn: [], isjoin=True]',
    'Query: [LiftFormTag: [Const: teststr, kids=[], TagName: foo, kids=[], Const: @=, kids=[], Const: 2016, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr:tick, kids=[], Const: =, kids=[], Const: 2015, kids=[]]]',
    'Query: [LiftPropBy: [Const: inet:fqdn, kids=[], Const: =, kids=[], Const: woot.com, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:ipv4, kids=[], VarValue: [Const: foo, kids=[]]]]',
    'Query: [LiftProp: [Const: pivcomp, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: (), kids=[]]]',
    'Query: [LiftProp: [Const: pivcomp, kids=[]], FormPivot: [AbsProp: testint, kids=[]], isjoin=False]',
    'Query: [LiftPropBy: [Const: testint, kids=[], Const: =, kids=[], Const: 3735928559, kids=[]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: ^=, kids=[], Const: us., kids=[]]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: =, kids=[], Const: us.v, kids=[]]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: ^=, kids=[], Const: us.va, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: foo, kids=[]], PivotInFrom: [AbsProp: has, kids=[]], isjoin=False]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: visi, kids=[]], PivotToTags: [TagMatch: *, kids=[]], isjoin=False]',
    "Query: [LiftProp: [Const: inet:user, kids=[]], CmdOper: [Const: limit, kids=[], Const: ('1',), kids=[]]]",
    "Query: [CmdOper: [Const: movetag, kids=[], Const: ('#hehe', '#woot'), kids=[]]]",
    'Query: [LiftPropBy: [Const: pivcomp, kids=[], Const: =, kids=[], List: None]]',
    'Query: [LiftProp: [Const: testcomp, kids=[]], FormPivot: [AbsProp: testint, kids=[]], isjoin=False]',
    "Query: [LiftProp: [Const: testguid, kids=[]], CmdOper: [Const: max, kids=[], Const: ('tick',), kids=[]]]",
    "Query: [LiftProp: [Const: testguid, kids=[]], CmdOper: [Const: min, kids=[], Const: ('tick',), kids=[]]]",
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 3, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: , kids=[]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: ^=, kids=[], Const: us.v, kids=[]]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: =, kids=[], Const: us.va, kids=[]]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: ^=, kids=[], Const: us.va., kids=[]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: testint, kids=[], Const: >, kids=[], Const: 10, kids=[]]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: testint, kids=[], Const: <, kids=[], Const: 30, kids=[]]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], TagValuCond: [TagName: foo, kids=[], Const: @=, kids=[], Const: 2016, kids=[]]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], EditTagAdd: [TagName: foo.bar, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: foo, kids=[]], PivotInFrom: [AbsProp: has, kids=[]], isjoin=True]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: =, kids=[], Const: 2015, kids=[]]]]',
    'Query: [LiftPropBy: [Const: .created, kids=[], Const: =, kids=[], Const: {created}, kids=[]]]',
    'Query: [LiftProp: [Const: inet:ipv4, kids=[]], FormPivot: [AbsProp: teststr, kids=[]], isjoin=False]',
    "Query: [LiftProp: [Const: inet:user, kids=[]], CmdOper: [Const: limit, kids=[], Const: ('1',), kids=[]]]",
    'Query: [EditNodeAdd: [AbsProp: pivcomp, kids=[], List: None]]',
    'Query: [LiftPropBy: [Const: syn:tag, kids=[], Const: =, kids=[], Const: foo.bar, kids=[]], PivotOut: [], isjoin=False]',
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 12, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: us, kids=[]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: ^=, kids=[], Const: us.va, kids=[]]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: =, kids=[], Const: us.va.sy, kids=[]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: testint, kids=[], Const: >=, kids=[], Const: 10, kids=[]]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: testint, kids=[], Const: <=, kids=[], Const: 30, kids=[]]]]',
    'Query: [LiftProp: [Const: inet:dns:a, kids=[]], PropPivotOut: [RelProp: ipv4, kids=[]], isjoin=False]',
    'Query: [LiftPropBy: [Const: inet:ipv4, kids=[], Const: =, kids=[], Const: 10.2.1.1/28, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 1.2.3.4, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: pivcomp, kids=[], List: None]]',
    "Query: [CmdOper: [Const: reindex, kids=[], Const: ('--form-counts',), kids=[]]]",
    'Query: [LiftTag: [TagName: test.bar, kids=[]], FiltOper: [Const: -, kids=[], TagCond: [TagName: test, kids=[]]], PivotIn: [], isjoin=False]',
    'Query: [LiftTag: [TagName: test.bar, kids=[]], FiltOper: [Const: -, kids=[], TagCond: [TagName: test, kids=[]]], PivotOut: [], isjoin=False]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: ^=, kids=[], Const: us.va., kids=[]]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: bar, kids=[]], EditTagAdd: [TagName: baz, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: foo, kids=[]], EditTagAdd: [TagName: bar, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: foo, kids=[]], CmdOper: [Const: delnode, kids=[], Const: (), kids=[]]]',
    'Query: [LiftPropBy: [Const: pivcomp, kids=[], Const: =, kids=[], List: None], PivotOut: [], isjoin=False]',
    'Query: [LiftPropBy: [Const: seen:source, kids=[], Const: =, kids=[], VarValue: [Const: sorc, kids=[]]], PivotOut: [], isjoin=False]',
    'Query: [CmdOper: [Const: sudo, kids=[], Const: (), kids=[]], EditNodeAdd: [AbsProp: teststr, kids=[], Const: foo, kids=[]]]',
    'Query: [LiftTag: [TagName: test.bar, kids=[]], FiltOper: [Const: -, kids=[], TagCond: [TagName: test, kids=[]]], PivotIn: [], isjoin=True]',
    'Query: [LiftTag: [TagName: test.bar, kids=[]], FiltOper: [Const: -, kids=[], TagCond: [TagName: test, kids=[]]], PivotOut: [], isjoin=True]',
    'Query: [LiftPropBy: [Const: testcomp:haha, kids=[], Const: ~=, kids=[], Const: ^lulz, kids=[]]]',
    'Query: [LiftPropBy: [Const: testcomp:haha, kids=[], Const: ~=, kids=[], Const: ^zerg, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint, kids=[], Const: =, kids=[], Const: 123, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: (), kids=[]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: =, kids=[], Const: us.va.sy, kids=[]]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: 123, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: (), kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: foobar, kids=[]], FormPivot: [AbsProp: has, kids=[]], isjoin=True]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: foo, kids=[]], EditTagAdd: [VarValue: [Const: tag, kids=[]]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: haha, kids=[]], EditTagAdd: [TagName: foo, kids=[]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: @=, kids=[], List: None]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: visi, kids=[]], PivotToTags: [TagMatch: baz.*, kids=[]], isjoin=False]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: visi, kids=[]], PivotToTags: [TagMatch: foo.*, kids=[]], isjoin=False]',
    'Query: [LiftPropBy: [Const: pivcomp, kids=[], Const: =, kids=[], List: None], PivotOut: [], isjoin=True]',
    'Query: [CmdOper: [Const: sudo, kids=[], Const: (), kids=[]], EditNodeAdd: [AbsProp: testguid, kids=[], Const: *, kids=[]]]',
    'Query: [LiftTag: [TagName: test.bar, kids=[]], FiltOper: [Const: +, kids=[], HasAbsPropCond: [AbsProp: pivcomp, kids=[]]], PivotOut: [], isjoin=False]',
    'Query: [LiftTag: [TagName: test.bar, kids=[]], FiltOper: [Const: +, kids=[], HasAbsPropCond: [AbsProp: teststr, kids=[]]], PivotIn: [], isjoin=False]',
    'Query: [EditNodeAdd: [AbsProp: testcomp, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 10, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: us.va, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: ^=, kids=[], Const: us.va.fair, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: =, kids=[], Const: us.va.syria, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: foo, kids=[]], FiltOper: [Const: +, kids=[], TagValuCond: [TagName: lol, kids=[], Const: @=, kids=[], Const: 2014, kids=[]]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: foo, kids=[]], FiltOper: [Const: +, kids=[], TagValuCond: [TagName: lol, kids=[], Const: @=, kids=[], Const: 2016, kids=[]]]]',
    "Query: [LiftProp: [Const: teststr, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-d', '3'), kids=[]]]",
    'Query: [EditNodeAdd: [AbsProp: inet:fqdn, kids=[], Const: woot.com, kids=[]]]',
    'Query: [LiftPropBy: [Const: inet:ipv4, kids=[], Const: =, kids=[], Const: 192.168.1.0/24, kids=[]]]',
    "Query: [LiftProp: [Const: inet:user, kids=[]], CmdOper: [Const: limit, kids=[], Const: ('--woot',), kids=[]]]",
    'Query: [LiftTag: [TagName: test.bar, kids=[]], FiltOper: [Const: +, kids=[], HasAbsPropCond: [AbsProp: pivcomp, kids=[]]], PivotOut: [], isjoin=True]',
    'Query: [LiftTag: [TagName: test.bar, kids=[]], FiltOper: [Const: +, kids=[], HasAbsPropCond: [AbsProp: teststr, kids=[]]], PivotIn: [], isjoin=True]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: =, kids=[], Const: us.va.sydney, kids=[]]]',
    'Query: [LiftFormTag: [Const: teststr, kids=[], TagName: foo, kids=[], Const: @=, kids=[], List: None]]',
    'Query: [LiftPropBy: [Const: inet:ipv4, kids=[], Const: =, kids=[], Const: 1.2.3.1-1.2.3.3, kids=[]]]',
    "Query: [LiftProp: [Const: pivcomp, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('--join',), kids=[]]]",
    'Query: [EditNodeAdd: [AbsProp: testguid, kids=[], Const: *, kids=[]], EditPropSet: [RelProp: tick, kids=[], Const: 2001, kids=[]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: ^=, kids=[], Const: us.va.fair, kids=[]]]]',
    "Query: [LiftProp: [Const: teststr, kids=[]], CmdOper: [Const: delnode, kids=[], Const: ('--force',), kids=[]]]",
    'Query: [LiftPropBy: [Const: teststr:tick, kids=[], Const: <, kids=[], Const: 201808021202, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr:tick, kids=[], Const: >, kids=[], Const: 201808021202, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: woot, kids=[]], EditPropSet: [UnivProp: .seen, kids=[], Const: 20, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: woot, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [UnivProp: .seen, kids=[]], Const: @=, kids=[], Const: 2012, kids=[]]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: woot, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [UnivProp: .seen, kids=[]], Const: @=, kids=[], Const: 2015, kids=[]]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: woot, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [UnivProp: .seen, kids=[]], Const: @=, kids=[], TagPropValue: [TagName: bar, kids=[]]]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: woot, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [UnivProp: .seen, kids=[]], Const: @=, kids=[], TagPropValue: [TagName: baz, kids=[]]]]]',
    "Query: [LiftPropBy: [Const: inet:ipv4, kids=[], Const: =, kids=[], Const: 1.2.3.4, kids=[]], CmdOper: [Const: limit, kids=[], Const: ('20',), kids=[]]]",
    'Query: [LiftProp: [Const: inet:ipv4, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: asn::name, kids=[]], Const: =, kids=[], Const: visi, kids=[]]]]',
    "Query: [LiftProp: [Const: inet:ipv4, kids=[]], CmdOper: [Const: reindex, kids=[], Const: ('--subs',), kids=[]]]",
    'Query: [CmdOper: [Const: sudo, kids=[], Const: (), kids=[]], LiftPropBy: [Const: testint, kids=[], Const: =, kids=[], Const: 6, kids=[]], CmdOper: [Const: delnode, kids=[], Const: (), kids=[]]]',
    'Query: [LiftPropBy: [Const: syn:tag, kids=[], Const: =, kids=[], Const: aaa.barbarella.ddd, kids=[]]]',
    'Query: [LiftPropBy: [Const: syn:tag, kids=[], Const: =, kids=[], Const: foo.bar, kids=[]], FormPivot: [AbsProp: teststr, kids=[]], isjoin=False]',
    'Query: [EditNodeAdd: [AbsProp: testguid, kids=[], Const: abcd, kids=[]], EditPropSet: [RelProp: tick, kids=[], Const: 2015, kids=[]]]',
    "Query: [LiftPropBy: [Const: testint, kids=[], Const: =, kids=[], Const: 123, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-te',), kids=[]]]",
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 9, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: us.à¤“à¤‚, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: ^=, kids=[], Const: us.va.fairfax, kids=[]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: =, kids=[], Const: us.va.sydney, kids=[]]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: foo bar, kids=[]], FiltOper: [Const: +, kids=[], HasAbsPropCond: [AbsProp: teststr, kids=[]]]]',
    "Query: [LiftProp: [Const: teststr, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-d', '3', '-u'), kids=[]]]",
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: @=, kids=[], List: None]]]',
    'Query: [LiftPropBy: [Const: teststr:tick, kids=[], Const: <=, kids=[], Const: 201808021202, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr:tick, kids=[], Const: >=, kids=[], Const: 201808021202, kids=[]]]',
    'Query: [LiftPropBy: [Const: .created, kids=[], Const: *range=, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: inet:asn, kids=[], Const: 200, kids=[]], EditPropSet: [RelProp: name, kids=[], Const: visi, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:fqdn, kids=[], Const: woot.com, kids=[]], PivotOut: [], isjoin=False]',
    'Query: [EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 1.2.3.1-1.2.3.3, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 192.168.1.0/24, kids=[]]]',
    'Query: [LiftPropBy: [Const: pivtarg, kids=[], Const: =, kids=[], Const: hehe, kids=[]], EditPropSet: [UnivProp: .seen, kids=[], Const: 2015, kids=[]]]',
    'Query: [LiftPropBy: [Const: ps:person, kids=[], Const: =, kids=[], VarValue: [Const: pers, kids=[]]], FormPivot: [AbsProp: has, kids=[]], isjoin=False, PivotOut: [], isjoin=False]',
    'Query: [EditNodeAdd: [AbsProp: testguid, kids=[], Const: *, kids=[]], EditPropSet: [RelProp: tick, kids=[], Const: 2015, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: testguid, kids=[], Const: *, kids=[]], EditPropSet: [RelProp: tick, kids=[], Const: 2016, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: testguid, kids=[], Const: *, kids=[]], EditPropSet: [RelProp: tick, kids=[], Const: 2017, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: ^=, kids=[], Const: us.va.fairfax., kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: bar, kids=[]], FormPivot: [AbsProp: pivcomp:lulz, kids=[]], isjoin=False]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: beep, kids=[]], EditNodeAdd: [AbsProp: teststr, kids=[], Const: boop, kids=[]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], TagValuCond: [TagName: foo, kids=[], Const: @=, kids=[], List: None]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], TagValuCond: [TagName: foo, kids=[], Const: @=, kids=[], List: None]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: foo, kids=[]], EditNodeAdd: [AbsProp: teststr, kids=[], Const: bar, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: haha, kids=[]], EditTagAdd: [TagName: bar, kids=[], Const: 2015, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: haha, kids=[]], EditTagAdd: [TagName: bar, kids=[], Const: 2016, kids=[]]]',
    'Query: [LiftPropBy: [Const: .created, kids=[], Const: *range=, kids=[], List: None]]',
    'Query: [LiftPropBy: [Const: geo:place, kids=[], Const: =, kids=[], VarValue: [Const: place, kids=[]]], PivotInFrom: [AbsProp: has, kids=[]], isjoin=False, PivotIn: [], isjoin=False]',
    'Query: [LiftPropBy: [Const: inet:fqdn, kids=[], Const: =, kids=[], Const: woot.com, kids=[]], CmdOper: [Const: delnode, kids=[], Const: (), kids=[]]]',
    'Query: [LiftPropBy: [Const: pivcomp, kids=[], Const: =, kids=[], List: None], FormPivot: [AbsProp: pivtarg, kids=[]], isjoin=False]',
    'Query: [LiftPropBy: [Const: seen:source, kids=[], Const: =, kids=[], VarValue: [Const: sorc, kids=[]]], PropPivotOut: [RelProp: node, kids=[]], isjoin=False]',
    'Query: [CmdOper: [Const: sudo, kids=[], Const: (), kids=[]], EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 1.2.3.4, kids=[]]]',
    'Query: [CmdOper: [Const: sudo, kids=[], Const: (), kids=[]], EditNodeAdd: [AbsProp: teststr, kids=[], Const: foo, kids=[]], EditTagAdd: [TagName: lol, kids=[]]]',
    'Query: [LiftProp: [Const: testcomp, kids=[]], PivotOut: [], isjoin=False, CmdOper: [Const: uniq, kids=[], Const: (), kids=[]], CmdOper: [Const: count, kids=[], Const: (), kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 1, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: us.va.syria, kids=[]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: ^=, kids=[], Const: us.va.fairfax, kids=[]]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: =, kids=[], Const: us.va. syria, kids=[]]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: bar, kids=[]], FormPivot: [AbsProp: pivcomp:lulz, kids=[]], isjoin=True]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: foo bar, kids=[]], EditPropDel: [RelProp: tick, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: hello, kids=[]], EditPropSet: [RelProp: tick, kids=[], Const: 2001, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: hello, kids=[]], EditPropSet: [RelProp: tick, kids=[], Const: 2002, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 1.2.3.4, kids=[]], EditPropSet: [RelProp: asn, kids=[], Const: 20, kids=[]]]',
    "Query: [LiftProp: [Const: inet:user, kids=[]], CmdOper: [Const: limit, kids=[], Const: ('1',), kids=[]]]",
    'Query: [LiftPropBy: [Const: pivcomp, kids=[], Const: =, kids=[], List: None], FormPivot: [AbsProp: pivtarg, kids=[]], isjoin=True]',
    'Query: [LiftPropBy: [Const: syn:tag, kids=[], Const: =, kids=[], Const: baz.faz, kids=[]], EditTagAdd: [TagName: foo.bar, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 2, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: us.va.sydney, kids=[]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: ^=, kids=[], Const: us.va.fairfax., kids=[]]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 1.2.3.4, kids=[]], EditPropSet: [RelProp: asn, kids=[], Const: 200, kids=[]]]',
    "Query: [CmdOper: [Const: movetag, kids=[], Const: ('#aaa.b', '#aaa.barbarella'), kids=[]]]",
    "Query: [LiftProp: [Const: pivcomp, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('--join', '-d', '3'), kids=[]]]",
    'Query: [LiftPropBy: [Const: ps:person, kids=[], Const: =, kids=[], VarValue: [Const: pers, kids=[]]], FormPivot: [AbsProp: wentto, kids=[]], isjoin=False, PivotOut: [], isjoin=False]',
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 4, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: us.va.fairfax, kids=[]]]',
    'Query: [VarSetOper: [Const: bar, kids=[], Const: 5.5.5.5, kids=[]], EditNodeAdd: [AbsProp: inet:ipv4, kids=[], VarValue: [Const: bar, kids=[]]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:dns:a, kids=[], FuncCall: [VarDeref: [VarValue: [Const: blob, kids=[]], Const: split, kids=[]], CallArgs: [Const: |, kids=[]]]]]',
    'Query: [LiftProp: [Const: inet:ipv4, kids=[]], FiltOper: [Const: -, kids=[], AbsPropCond: [AbsProp: inet:ipv4, kids=[], Const: =, kids=[], Const: 1.2.3.0/30, kids=[]]]]',
    'Query: [LiftProp: [Const: inet:ipv4, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: inet:ipv4, kids=[], Const: =, kids=[], Const: 1.2.3.0/30, kids=[]]]]',
    'Query: [EditNodeAdd: [AbsProp: pivcomp, kids=[], List: None], EditPropSet: [RelProp: width, kids=[], Const: 42, kids=[]]]',
    'Query: [CmdOper: [Const: sudo, kids=[], Const: (), kids=[]], EditNodeAdd: [AbsProp: teststr, kids=[], Const: 123, kids=[]], EditPropSet: [RelProp: tick, kids=[], Const: 2018, kids=[]]]',
    'Query: [LiftPropBy: [Const: syn:tag, kids=[], Const: =, kids=[], Const: foo.bar, kids=[]], FormPivot: [AbsProp: teststr:tick, kids=[]], isjoin=False]',
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 1, kids=[]], EditNodeAdd: [AbsProp: testint, kids=[], Const: 2, kids=[]], EditNodeAdd: [AbsProp: testint, kids=[], Const: 3, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 8, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: us.ca.sandiego, kids=[]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], TagValuCond: [TagName: foo, kids=[], Const: @=, kids=[], List: None]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], EditTagAdd: [TagName: foo.bar, kids=[], List: None]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: foo bar, kids=[]], FiltOper: [Const: -, kids=[], HasAbsPropCond: [AbsProp: teststr:tick, kids=[]]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: foo bar, kids=[]], EditPropSet: [RelProp: tick, kids=[], Const: 2018, kids=[]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: =, kids=[], List: None]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: @=, kids=[], List: None]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: visi, kids=[]], EditTagAdd: [TagName: foo.bar, kids=[]], PivotToTags: [TagMatch: , kids=[]], isjoin=False]',
    'Query: [LiftPropBy: [Const: inet:fqdn, kids=[], Const: =, kids=[], Const: woot.com, kids=[]], FormPivot: [AbsProp: inet:dns:a, kids=[]], isjoin=False]',
    'Query: [LiftProp: [Const: inet:ipv4, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: inet:ipv4, kids=[], Const: =, kids=[], Const: 10.2.1.4/31, kids=[]]]]',
    'Query: [LiftProp: [Const: inet:ipv4, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: inet:ipv4, kids=[], Const: =, kids=[], Const: 10.2.1.4/32, kids=[]]]]',
    'Query: [EditNodeAdd: [AbsProp: pivcomp, kids=[], List: None], EditPropSet: [RelProp: tick, kids=[], Const: 2018, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: foobar, kids=[]], FormPivot: [AbsProp: has, kids=[]], isjoin=False, PivotInFrom: [AbsProp: teststr, kids=[]], isjoin=False]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: foo, kids=[]], EditPropSet: [RelProp: tick, kids=[], Const: 201808021201, kids=[]]]',
    "Query: [LiftProp: [Const: teststr, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-d', '3', '--unique'), kids=[]]]",
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: @=, kids=[], List: None]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: woot, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [UnivProp: .seen, kids=[]], Const: @=, kids=[], List: None]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: woot, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [UnivProp: .seen, kids=[]], Const: @=, kids=[], List: None]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:dns:a, kids=[], List: None]]',
    "Query: [LiftProp: [Const: pivcomp, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-j', '--degrees', '2'), kids=[]]]",
    'Query: [CmdOper: [Const: sudo, kids=[], Const: (), kids=[]], EditNodeAdd: [AbsProp: cycle0, kids=[], Const: foo, kids=[]], EditPropSet: [RelProp: cycle1, kids=[], Const: bar, kids=[]]]',
    'Query: [CmdOper: [Const: sudo, kids=[], Const: (), kids=[]], EditNodeAdd: [AbsProp: cycle1, kids=[], Const: bar, kids=[]], EditPropSet: [RelProp: cycle0, kids=[], Const: foo, kids=[]]]',
    'Query: [LiftProp: [Const: testcomp, kids=[]], FiltOper: [Const: +, kids=[], OrCond: [RelPropCond: [RelPropValue: [RelProp: hehe, kids=[]], Const: <, kids=[], Const: 2, kids=[]], RelPropCond: [RelPropValue: [RelProp: haha, kids=[]], Const: =, kids=[], Const: foob, kids=[]]]]]',
    'Query: [LiftProp: [Const: testcomp, kids=[]], FiltOper: [Const: +, kids=[], OrCond: [RelPropCond: [RelPropValue: [RelProp: hehe, kids=[]], Const: <, kids=[], Const: 2, kids=[]], RelPropCond: [RelPropValue: [RelProp: haha, kids=[]], Const: =, kids=[], Const: test, kids=[]]]]]',
    'Query: [LiftProp: [Const: testcomp, kids=[]], FiltOper: [Const: +, kids=[], OrCond: [RelPropCond: [RelPropValue: [RelProp: hehe, kids=[]], Const: <, kids=[], Const: 2, kids=[]], TagCond: [TagName: meep.gorp, kids=[]]]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: ^=, kids=[], Const: us.va.fairfax.reston, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: abcd, kids=[]], EditPropSet: [RelProp: tick, kids=[], Const: 2015, kids=[]], EditTagAdd: [TagName: cool, kids=[]], LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: foobar, kids=[]], FormPivot: [AbsProp: has, kids=[]], isjoin=False, PivotInFrom: [AbsProp: teststr, kids=[]], isjoin=True]',
    "Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: pennywise, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-d', '3'), kids=[]]]",
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: @=, kids=[], List: None]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: =, kids=[], List: None]]]',
    'Query: [LiftPropBy: [Const: pivcomp, kids=[], Const: =, kids=[], List: None], PropPivot: [RelPropValue: [RelProp: lulz, kids=[]], AbsProp: teststr, kids=[]], isjoin=False]',
    'Query: [LiftPropBy: [Const: pivcomp, kids=[], Const: =, kids=[], List: None], PropPivot: [RelPropValue: [RelProp: targ, kids=[]], AbsProp: pivtarg, kids=[]], isjoin=False]',
    'Query: [LiftPropBy: [Const: ps:person, kids=[], Const: =, kids=[], VarValue: [Const: pers, kids=[]]], FormPivot: [AbsProp: wentto, kids=[]], isjoin=False, PropPivotOut: [RelProp: n2, kids=[]], isjoin=False]',
    'Query: [LiftProp: [Const: testcomp, kids=[]], FiltOper: [Const: +, kids=[], AndCond: [RelPropCond: [RelPropValue: [RelProp: hehe, kids=[]], Const: <, kids=[], Const: 2, kids=[]], RelPropCond: [RelPropValue: [RelProp: haha, kids=[]], Const: =, kids=[], Const: foob, kids=[]]]]]',
    'Query: [LiftProp: [Const: testcomp, kids=[]], FiltOper: [Const: +, kids=[], AndCond: [RelPropCond: [RelPropValue: [RelProp: hehe, kids=[]], Const: <, kids=[], Const: 2, kids=[]], RelPropCond: [RelPropValue: [RelProp: haha, kids=[]], Const: =, kids=[], Const: test, kids=[]]]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: foo, kids=[]], EditTagAdd: [TagName: bar, kids=[]], FiltOper: [Const: +, kids=[], NotCond: [HasRelPropCond: [UnivProp: .seen, kids=[]]]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: foo, kids=[]], EditNodeAdd: [AbsProp: teststr, kids=[], Const: bar, kids=[]], CmdOper: [Const: spin, kids=[], Const: (), kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: hehe, kids=[]], EditTagAdd: [TagName: foo, kids=[], List: None]]',
    "Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: hehe, kids=[]], CmdOper: [Const: iden, kids=[], Const: ('abcd',), kids=[]], CmdOper: [Const: count, kids=[], Const: (), kids=[]]]",
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: teststr:tick, kids=[], Const: <, kids=[], Const: 201808021202, kids=[]]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: teststr:tick, kids=[], Const: >, kids=[], Const: 201808021202, kids=[]]]]',
    'Query: [LiftPropBy: [Const: teststr:tick, kids=[], Const: =, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: woot, kids=[]], EditTagAdd: [TagName: foo, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: woot, kids=[]], EditPropSet: [UnivProp: .seen, kids=[], List: None]]',
    "Query: [LiftPropBy: [Const: cluster, kids=[], Const: =, kids=[], Const: abcd, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-d', '2', '--join'), kids=[]]]",
    'Query: [LiftPropBy: [Const: pivcomp, kids=[], Const: =, kids=[], List: None], PropPivot: [RelPropValue: [RelProp: lulz, kids=[]], AbsProp: teststr, kids=[]], isjoin=True]',
    'Query: [LiftPropBy: [Const: ps:person, kids=[], Const: =, kids=[], VarValue: [Const: pers, kids=[]]], FormPivot: [AbsProp: has, kids=[]], isjoin=False, FormPivot: [AbsProp: geo:place, kids=[]], isjoin=False]',
    'Query: [LiftPropBy: [Const: ps:person, kids=[], Const: =, kids=[], VarValue: [Const: pers, kids=[]]], FormPivot: [AbsProp: has, kids=[]], isjoin=False, FormPivot: [AbsProp: inet:ipv4, kids=[]], isjoin=False]',
    'Query: [EditNodeAdd: [AbsProp: seen, kids=[], List: None]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: ^=, kids=[], Const: us.va.fairfax.reston, kids=[]]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], EditTagAdd: [TagName: foo.bar, kids=[], List: None]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: teststr:tick, kids=[], Const: <=, kids=[], Const: 201808021202, kids=[]]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: teststr:tick, kids=[], Const: >=, kids=[], Const: 201808021202, kids=[]]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: =, kids=[], List: None]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: =, kids=[], List: None]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: woot, kids=[]], VarSetOper: [Const: foo, kids=[], TagPropValue: [TagName: foo, kids=[]]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [UnivProp: .seen, kids=[]], Const: @=, kids=[], VarValue: [Const: foo, kids=[]]]]]',
    'Query: [LiftPropBy: [Const: geo:place:latlong, kids=[], Const: *near=, kids=[], List: None]]',
    'Query: [LiftPropBy: [Const: geo:place, kids=[], Const: =, kids=[], VarValue: [Const: place, kids=[]]], PivotInFrom: [AbsProp: has, kids=[]], isjoin=False, PivotInFrom: [AbsProp: inet:ipv4, kids=[]], isjoin=False]',
    'Query: [LiftPropBy: [Const: geo:place, kids=[], Const: =, kids=[], VarValue: [Const: place, kids=[]]], PivotInFrom: [AbsProp: has, kids=[]], isjoin=False, PivotInFrom: [AbsProp: ps:person, kids=[]], isjoin=False]',
    'Query: [LiftProp: [Const: inet:ipv4, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: inet:ipv4, kids=[], Const: =, kids=[], Const: 1.2.3.1-1.2.3.3, kids=[]]]]',
    "Query: [LiftProp: [Const: inet:user, kids=[]], CmdOper: [Const: limit, kids=[], Const: ('10',), kids=[]], EditTagAdd: [TagName: foo.bar, kids=[]]]",
    'Query: [EditNodeAdd: [AbsProp: inet:user, kids=[], Const: visi, kids=[]], EditNodeAdd: [AbsProp: inet:user, kids=[], Const: whippit, kids=[]]]',
    'Query: [LiftPropBy: [Const: testint:loc, kids=[], Const: ^=, kids=[], Const: us.va.fairfax.chantilly, kids=[]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: =, kids=[], List: None]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: @=, kids=[], List: None]]]',
    "Query: [CmdOper: [Const: iden, kids=[], Const: ('2cdd997872b10a65407ad5fadfa28e0d',), kids=[]]]",
    "Query: [LiftProp: [Const: pivcomp, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('--join', '--degrees', '2'), kids=[]]]",
    'Query: [LiftProp: [Const: testguid, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: testguid, kids=[], Const: *range=, kids=[], List: None]]]',
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 5, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: us.va.fairfax.reston, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: visi, kids=[]], EditNodeAdd: [AbsProp: testint, kids=[], Const: 20, kids=[]], EditTagAdd: [TagName: foo.bar, kids=[]]]',
    "Query: [LiftProp: [Const: inet:user, kids=[]], CmdOper: [Const: limit, kids=[], Const: ('10',), kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: inet:user, kids=[], Const: =, kids=[], Const: visi, kids=[]]]]",
    'Query: [LiftPropBy: [Const: ps:person, kids=[], Const: =, kids=[], VarValue: [Const: pers, kids=[]]], FormPivot: [AbsProp: wentto, kids=[]], isjoin=False, FormPivot: [AbsProp: inet:ipv4, kids=[]], isjoin=False]',
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 7, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: us.va.fairfax.herndon, kids=[]]]',
    'Query: [LiftProp: [Const: testint, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: ^=, kids=[], Const: us.va.fairfax.chantilly, kids=[]]]]',
    "Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: 123, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('--traverse-edge',), kids=[]]]",
    "Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: foo, kids=[]], EditNodeAdd: [AbsProp: teststr, kids=[], Const: bar, kids=[]], CmdOper: [Const: sleep, kids=[], Const: ('10',), kids=[]]]",
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: foo, kids=[]], EditNodeAdd: [AbsProp: teststr, kids=[], Const: bar, kids=[]], EditNodeAdd: [AbsProp: testint, kids=[], Const: 42, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:dns:query, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 94.75.194.194, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: nl, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: refs, kids=[], List: None]]',
    'Query: [LiftPropBy: [Const: source, kids=[], Const: =, kids=[], Const: 8f1401de15918358d5247e21ca29a814, kids=[]]]',
    'Query: [LiftProp: [Const: testcomp, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: haha, kids=[]], Const: *range=, kids=[], List: None]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: 123, kids=[]], EditPropSet: [RelProp: baz, kids=[], Const: testguid:tick=2015, kids=[]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: @=, kids=[], List: None]]]',
    'Query: [EditNodeAdd: [AbsProp: geo:place, kids=[], Const: *, kids=[]], EditPropSet: [RelProp: latlong, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: inet:fqdn, kids=[], Const: woot.com, kids=[]], EditTagAdd: [TagName: bad, kids=[], List: None]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: 1234, kids=[]], LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: duck, kids=[]], LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: knight, kids=[]]]',
    "Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: pennywise, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('--join', '-d', '9'), kids=[]]]",
    'Query: [EditNodeAdd: [AbsProp: has, kids=[], List: None]]',
    'Query: [LiftPropBy: [Const: inet:dns:a, kids=[], Const: =, kids=[], List: None], VarSetOper: [Const: newp, kids=[], UnivPropValue: [UnivProp: .seen, kids=[]]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:dns:a, kids=[], List: None], EditTagAdd: [TagName: yepr, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: foo, kids=[]], EditTagAdd: [TagName: bar, kids=[]], SubQuery: [Query: [EditTagAdd: [TagName: baz, kids=[]], FiltOper: [Const: -, kids=[], TagCond: [TagName: bar, kids=[]]]]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: @=, kids=[], List: None]]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: *range=, kids=[], List: None]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 1.2.3.0/30, kids=[]], EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 5.5.5.5, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: bar, kids=[]], LiftPropBy: [Const: pivcomp, kids=[], Const: =, kids=[], List: None], EditTagAdd: [TagName: test.bar, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: foo, kids=[]], EditTagAdd: [TagName: bar, kids=[]], FiltOper: [Const: +, kids=[], OrCond: [TagCond: [TagName: baz, kids=[]], NotCond: [HasRelPropCond: [UnivProp: .seen, kids=[]]]]]]',
    "Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: pennywise, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-d', '3', '-ot=omit'), kids=[]]]",
    'Query: [ForLoop: [Const: fqdn, kids=[], VarValue: [Const: fqdns, kids=[]], SubQuery: [Query: [EditNodeAdd: [AbsProp: inet:fqdn, kids=[], VarValue: [Const: fqdn, kids=[]]]]]]]',
    'Query: [LiftProp: [Const: inet:dns:a, kids=[]], FiltOper: [Const: -, kids=[], SubqCond: [Query: [PropPivot: [RelPropValue: [RelProp: ipv4, kids=[]], AbsProp: inet:ipv4, kids=[]], isjoin=False, FiltOper: [Const: -, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: =, kids=[], Const: us, kids=[]]]]]]]',
    'Query: [LiftProp: [Const: inet:dns:a, kids=[]], FiltOper: [Const: -, kids=[], SubqCond: [Query: [PropPivot: [RelPropValue: [RelProp: ipv4, kids=[]], AbsProp: inet:ipv4, kids=[]], isjoin=False, FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: =, kids=[], Const: us, kids=[]]]]]]]',
    'Query: [LiftProp: [Const: inet:dns:a, kids=[]], FiltOper: [Const: +, kids=[], SubqCond: [Query: [PropPivot: [RelPropValue: [RelProp: ipv4, kids=[]], AbsProp: inet:ipv4, kids=[]], isjoin=False, FiltOper: [Const: -, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: =, kids=[], Const: us, kids=[]]]]]]]',
    'Query: [LiftProp: [Const: inet:dns:a, kids=[]], FiltOper: [Const: +, kids=[], SubqCond: [Query: [PropPivot: [RelPropValue: [RelProp: ipv4, kids=[]], AbsProp: inet:ipv4, kids=[]], isjoin=False, FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: loc, kids=[]], Const: =, kids=[], Const: us, kids=[]]]]]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:dns:a, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: inet:fqdn, kids=[], Const: vertex.link, kids=[]], EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 1.2.3.4, kids=[]]]',
    'Query: [LiftPropBy: [Const: inet:ipv4, kids=[], Const: =, kids=[], Const: 1.2.3.4, kids=[]], FiltOper: [Const: +, kids=[], SubqCond: [Query: [FormPivot: [AbsProp: inet:dns:a, kids=[]], isjoin=False], Const: <=, kids=[], Const: 1, kids=[]]]]',
    'Query: [LiftPropBy: [Const: inet:ipv4, kids=[], Const: =, kids=[], Const: 1.2.3.4, kids=[]], FiltOper: [Const: +, kids=[], SubqCond: [Query: [FormPivot: [AbsProp: inet:dns:a, kids=[]], isjoin=False], Const: >=, kids=[], Const: 3, kids=[]]]]',
    'Query: [EditNodeAdd: [AbsProp: testcomp, kids=[], List: None], EditTagAdd: [TagName: foo.bar, kids=[]], EditTagDel: [TagName: foo.bar, kids=[]]]',
    'Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: a, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: tick, kids=[]], Const: *range=, kids=[], List: None]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:dns:a, kids=[], List: None], EditTagAdd: [TagName: nope, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: testcomp, kids=[], List: None], EditNodeAdd: [AbsProp: testcomp, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 6, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: us.va.fairfax.restonheights, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: a, kids=[]], SwitchCase: [VarValue: [Const: woot, kids=[]], CaseEntry: [Const: hehe, kids=[], SubQuery: [Query: [EditTagAdd: [TagName: baz, kids=[]]]]]]]',
    "Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: pennywise, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-d', '3', '-of=source'), kids=[]]]",
    'Query: [LiftPropBy: [Const: geo:place:latlong, kids=[], Const: *near=, kids=[], List: None]]',
    'Query: [LiftProp: [Const: inet:dns:a, kids=[]], FiltOper: [Const: +, kids=[], SubqCond: [Query: [PropPivot: [RelPropValue: [RelProp: ipv4, kids=[]], AbsProp: inet:ipv4, kids=[]], isjoin=False, FiltOper: [Const: -, kids=[], RelPropCond: [RelPropValue: [RelProp: asn, kids=[]], Const: =, kids=[], Const: 1234, kids=[]]]]]]]',
    'Query: [LiftProp: [Const: inet:dns:a, kids=[]], FiltOper: [Const: +, kids=[], SubqCond: [Query: [PropPivot: [RelPropValue: [RelProp: ipv4, kids=[]], AbsProp: inet:ipv4, kids=[]], isjoin=False, FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: asn, kids=[]], Const: =, kids=[], Const: 1234, kids=[]]]]]]]',
    'Query: [LiftPropBy: [Const: inet:fqdn, kids=[], Const: =, kids=[], Const: woot.com, kids=[]], FormPivot: [AbsProp: inet:dns:a, kids=[]], isjoin=False, FormPivot: [AbsProp: inet:ipv4, kids=[]], isjoin=False]',
    'Query: [LiftPropBy: [Const: pivcomp, kids=[], Const: =, kids=[], List: None], FiltOper: [Const: -, kids=[], SubqCond: [Query: [PropPivot: [RelPropValue: [RelProp: lulz, kids=[]], AbsProp: teststr, kids=[]], isjoin=False, FiltOper: [Const: +, kids=[], TagCond: [TagName: baz, kids=[]]]]]]]',
    "Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: pennywise, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-d', '3', '-otf=source'), kids=[]]]",
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: visi, kids=[]], EditTagAdd: [TagName: foo.bar, kids=[]], PivotToTags: [TagMatch: , kids=[]], isjoin=False, EditTagAdd: [TagName: baz.faz, kids=[]]]',
    'Query: [LiftProp: [Const: geo:place, kids=[]], FiltOper: [Const: -, kids=[], RelPropCond: [RelPropValue: [RelProp: latlong, kids=[]], Const: *near=, kids=[], List: None]]]',
    "Query: [LiftPropBy: [Const: inet:asn, kids=[], Const: =, kids=[], Const: 10, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-of', 'inet:ipv4', '--join', '-d', '3'), kids=[]]]",
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: bar, kids=[]], Const: *range=, kids=[], List: None]]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: oof, kids=[]], EditTagAdd: [TagName: bar, kids=[]], SubQuery: [Query: [EditNodeAdd: [AbsProp: testint, kids=[], Const: 0xdeadbeef, kids=[]]]]]',
    'Query: [LiftPropBy: [Const: inet:ipv4, kids=[], Const: =, kids=[], Const: 12.34.56.78, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: us.oh.wilmington, kids=[]]]',
    "Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: pennywise, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-d', '3', '--omit-tag=omit'), kids=[]]]",
    'Query: [EditNodeAdd: [AbsProp: inet:dns:a, kids=[], List: None], EditPropSet: [UnivProp: .seen, kids=[], List: None]]',
    'Query: [LiftPropBy: [Const: inet:dns:a, kids=[], Const: =, kids=[], List: None], EditPropSet: [UnivProp: .seen, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: inet:dns:query, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: pivcomp, kids=[], List: None], EditPropSet: [RelProp: tick, kids=[], Const: 2015, kids=[]], EditTagAdd: [TagName: foo, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: refs, kids=[], List: None]]',
    "Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: pennywise, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-d', '3', '--omit-form=source'), kids=[]]]",
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: woot, kids=[]], EditTagAdd: [TagName: foo, kids=[], List: None], EditPropSet: [UnivProp: .seen, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: testcomp, kids=[], List: None], EditTagAdd: [TagName: meep.gorp, kids=[]], EditTagAdd: [TagName: bleep.zlorp, kids=[]], EditTagAdd: [TagName: cond, kids=[]]]',
    'Query: [LiftPropBy: [Const: inet:dns:a, kids=[], Const: =, kids=[], List: None], VarSetOper: [Const: hehe, kids=[], RelPropValue: [RelProp: fqdn, kids=[]]], FiltOper: [Const: -, kids=[], RelPropCond: [RelPropValue: [RelProp: fqdn, kids=[]], Const: =, kids=[], VarValue: [Const: hehe, kids=[]]]]]',
    'Query: [LiftPropBy: [Const: inet:dns:a, kids=[], Const: =, kids=[], List: None], VarSetOper: [Const: hehe, kids=[], RelPropValue: [RelProp: fqdn, kids=[]]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: fqdn, kids=[]], Const: =, kids=[], VarValue: [Const: hehe, kids=[]]]]]',
    'Query: [LiftPropBy: [Const: pivcomp, kids=[], Const: =, kids=[], List: None], FiltOper: [Const: +, kids=[], SubqCond: [Query: [PropPivot: [RelPropValue: [RelProp: lulz, kids=[]], AbsProp: teststr, kids=[]], isjoin=False, FiltOper: [Const: +, kids=[], TagCond: [TagName: baz, kids=[]]]]]], FiltOper: [Const: +, kids=[], HasAbsPropCond: [AbsProp: pivcomp, kids=[]]]]',
    'Query: [LiftProp: [Const: geo:place, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: geo:place:latlong, kids=[], Const: *near=, kids=[], List: None]]]',
    'Query: [LiftPropBy: [Const: inet:dns:query, kids=[], Const: =, kids=[], List: None], PropPivot: [RelPropValue: [RelProp: name, kids=[]], AbsProp: inet:fqdn, kids=[]], isjoin=False]',
    'Query: [EditNodeAdd: [AbsProp: source, kids=[], Const: abcd, kids=[]], EditTagAdd: [TagName: omit.nopiv, kids=[]], EditNodeAdd: [AbsProp: seen, kids=[], List: None]]',
    "Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: pennywise, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('--join', '-d', '9', '--traverse-edge'), kids=[]]]",
    'Query: [LiftPropBy: [Const: inet:dns:a, kids=[], Const: =, kids=[], List: None], VarSetOper: [Const: hehe, kids=[], RelPropValue: [RelProp: fqdn, kids=[]]], LiftPropBy: [Const: inet:fqdn, kids=[], Const: =, kids=[], VarValue: [Const: hehe, kids=[]]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 1.2.3.4, kids=[]], EditPropSet: [RelProp: asn, kids=[], Const: 10, kids=[]], EditNodeAdd: [AbsProp: seen, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: c, kids=[]], SwitchCase: [VarValue: [Const: woot, kids=[]], CaseEntry: [Const: hehe, kids=[], SubQuery: [Query: [EditTagAdd: [TagName: baz, kids=[]]]]], CaseEntry: [SubQuery: [Query: [EditTagAdd: [TagName: jaz, kids=[]]]]]]]',
    'Query: [LiftPropBy: [Const: geo:place:latlong, kids=[], Const: *near=, kids=[], List: None]]',
    'Query: [LiftPropBy: [Const: ps:person, kids=[], Const: =, kids=[], VarValue: [Const: pers, kids=[]]], FormPivot: [AbsProp: wentto, kids=[]], isjoin=False, FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: time, kids=[]], Const: @=, kids=[], List: None]], FormPivot: [AbsProp: geo:place, kids=[]], isjoin=False]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: woot, kids=[]], EditTagAdd: [TagName: foo, kids=[], List: None], EditTagAdd: [TagName: bar, kids=[]], EditPropSet: [UnivProp: .seen, kids=[], List: None]]',
    "Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: pennywise, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-d', '3', '-ott=omit.nopiv', '-ott=test'), kids=[]]]",
    "Query: [ForLoop: [VarList: ['fqdn', 'ipv4'], kids=[], VarValue: [Const: dnsa, kids=[]], SubQuery: [Query: [EditNodeAdd: [AbsProp: inet:dns:a, kids=[], List: None]]]]]",
    'Query: [LiftPropBy: [Const: geo:place:latlong, kids=[], Const: *near=, kids=[], List: None]]',
    'Query: [LiftProp: [Const: testcomp, kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: testcomp, kids=[], Const: *range=, kids=[], List: None]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 1.2.3.4, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: us, kids=[]], EditNodeAdd: [AbsProp: inet:dns:a, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 4.3.2.1, kids=[]], EditPropSet: [RelProp: loc, kids=[], Const: zz, kids=[]], EditNodeAdd: [AbsProp: inet:dns:a, kids=[], List: None]]',
    "Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: pennywise, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-d', '3', '--omit-traversal-form=source'), kids=[]]]",
    'Query: [LiftPropBy: [Const: pivcomp, kids=[], Const: =, kids=[], List: None], VarSetOper: [Const: ticktock, kids=[], TagPropValue: [TagName: foo, kids=[]]], FormPivot: [AbsProp: pivtarg, kids=[]], isjoin=False, FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [UnivProp: .seen, kids=[]], Const: @=, kids=[], VarValue: [Const: ticktock, kids=[]]]]]',
    "Query: [EditNodeAdd: [AbsProp: testcomp, kids=[], List: None], EditNodeAdd: [AbsProp: testcomp, kids=[], List: None], EditNodeAdd: [AbsProp: testcomp, kids=[], List: None], ForLoop: [VarList: ['fqdn', 'ipv4', 'boom'], kids=[], VarValue: [Const: dnsa, kids=[]], SubQuery: [Query: [EditNodeAdd: [AbsProp: inet:dns:a, kids=[], List: None]]]]]",
    'Query: [LiftProp: [Const: inet:fqdn, kids=[]], FiltOper: [Const: +, kids=[], TagCond: [TagName: bad, kids=[]]], VarSetOper: [Const: fqdnbad, kids=[], TagPropValue: [TagName: bad, kids=[]]], FormPivot: [AbsProp: inet:dns:a:fqdn, kids=[]], isjoin=False, FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [UnivProp: .seen, kids=[]], Const: @=, kids=[], VarValue: [Const: fqdnbad, kids=[]]]]]',
    'Query: [LiftPropBy: [Const: media:news, kids=[], Const: =, kids=[], Const: 00a1f0d928e25729b9e86e2d08c127ce, kids=[]], EditPropSet: [RelProp: summary, kids=[], Const: , kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: refs, kids=[], List: None]]',
    'Query: [LiftProp: [Const: teststr, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: .seen, kids=[]], Const: *range=, kids=[], List: None]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:dns:a, kids=[], List: None], EditNodeAdd: [AbsProp: inet:dns:a, kids=[], List: None]]',
    'Query: [LiftProp: [Const: refs, kids=[]], FiltOper: [Const: +, kids=[], RelPropCond: [RelPropValue: [RelProp: n1, kids=[]], Const: *range=, kids=[], List: None]]]',
    'Query: [LiftPropBy: [Const: inet:dns:query, kids=[], Const: =, kids=[], List: None], PropPivot: [RelPropValue: [RelProp: name, kids=[]], AbsProp: inet:fqdn, kids=[]], isjoin=False]',
    'Query: [LiftPropBy: [Const: inet:dns:a, kids=[], Const: =, kids=[], List: None], EditPropSet: [UnivProp: .seen, kids=[], List: None]]',
    'Query: [LiftProp: [Const: testint, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: (), kids=[]], FiltOper: [Const: +, kids=[], AbsPropCond: [AbsProp: testcomp, kids=[], Const: *range=, kids=[], List: None]]]',
    'Query: [EditNodeAdd: [AbsProp: refs, kids=[], List: None]]',
    'Query: [LiftPropBy: [Const: inet:dns:a, kids=[], Const: =, kids=[], List: None], VarSetOper: [Const: seen, kids=[], UnivPropValue: [UnivProp: .seen, kids=[]]], PropPivot: [RelPropValue: [RelProp: fqdn, kids=[]], AbsProp: inet:fqdn, kids=[]], isjoin=False, EditPropSet: [UnivProp: .seen, kids=[], VarValue: [Const: seen, kids=[]]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:fqdn, kids=[], Const: woot.com, kids=[]], EditNodeAdd: [AbsProp: inet:fqdn, kids=[], Const: vertex.link, kids=[]], EditNodeAdd: [AbsProp: inet:user, kids=[], RelPropValue: [RelProp: zone, kids=[]]], FiltOper: [Const: +, kids=[], HasAbsPropCond: [AbsProp: inet:user, kids=[]]]]',
    'Query: [LiftPropBy: [Const: inet:dns:a, kids=[], Const: =, kids=[], List: None], EditPropSet: [UnivProp: .seen, kids=[], List: None]]',
    'Query: [EditNodeAdd: [AbsProp: teststr, kids=[], Const: c, kids=[]], SwitchCase: [VarValue: [Const: woot, kids=[]], CaseEntry: [Const: hehe, kids=[], SubQuery: [Query: [EditTagAdd: [TagName: baz, kids=[]]]]], CaseEntry: [Const: haha hoho, kids=[], SubQuery: [Query: [EditTagAdd: [TagName: faz, kids=[]]]]], CaseEntry: [Const: lolz:lulz, kids=[], SubQuery: [Query: [EditTagAdd: [TagName: jaz, kids=[]]]]]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:fqdn, kids=[], Const: hehe.com, kids=[]], EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 127.0.0.1, kids=[]], EditNodeAdd: [AbsProp: hash:md5, kids=[], Const: d41d8cd98f00b204e9800998ecf8427e, kids=[]]]',
    "Query: [LiftPropBy: [Const: teststr, kids=[], Const: =, kids=[], Const: pennywise, kids=[]], CmdOper: [Const: noderefs, kids=[], Const: ('-d', '3', '--omit-traversal-tag=omit.nopiv', '--omit-traversal-tag=test'), kids=[]]]",
    'Query: [LiftPropBy: [Const: geo:place, kids=[], Const: =, kids=[], Const: abcd, kids=[]], VarSetOper: [Const: latlong, kids=[], RelPropValue: [RelProp: latlong, kids=[]]], VarSetOper: [Const: radius, kids=[], RelPropValue: [RelProp: radius, kids=[]]], CmdOper: [Const: spin, kids=[], Const: (), kids=[]], LiftPropBy: [Const: tel:mob:telem:latlong, kids=[], Const: *near=, kids=[], List: None]]',
    'Query: [LiftPropBy: [Const: inet:ipv4, kids=[], Const: =, kids=[], Const: 12.34.56.78, kids=[]], LiftPropBy: [Const: inet:fqdn, kids=[], Const: =, kids=[], Const: woot.com, kids=[]], EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 1.2.3.4, kids=[]], EditPropSet: [RelProp: asn, kids=[], Const: 10101, kids=[]], EditNodeAdd: [AbsProp: inet:fqdn, kids=[], Const: woowoo.com, kids=[]], EditTagAdd: [TagName: my.tag, kids=[]]]',
    "Query: [ForLoop: [Const: foo, kids=[], VarValue: [Const: foos, kids=[]], SubQuery: [Query: [VarListSetOper: [VarList: ['fqdn', 'ipv4'], kids=[], FuncCall: [VarDeref: [VarValue: [Const: foo, kids=[]], Const: split, kids=[]], CallArgs: [Const: |, kids=[]]]], EditNodeAdd: [AbsProp: inet:dns:a, kids=[], List: None]]]]]",
    'Query: [LiftProp: [Const: testint, kids=[]]]',
    'Query: [LiftProp: [Const: testint, kids=[]]]',
    'Query: [LiftProp: [Const: testint, kids=[]]]',
    'Query: [EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 1.2.3.4, kids=[]], SwitchCase: [VarValue: [Const: foo, kids=[]], CaseEntry: [Const: bar, kids=[], SubQuery: [Query: [EditTagAdd: [TagName: hehe.haha, kids=[]]]]], CaseEntry: [Const: baz faz, kids=[], SubQuery: [Query: []]]]]',
    "Query: [LiftProp: [Const: inet:fqdn, kids=[]], CmdOper: [Const: graph, kids=[], Const: ('--degrees', '2', '--filter', '{ -#nope }', '--pivot', '{ <- seen <- source }', '--form-pivot', 'inet:fqdn', '{<- * | limit 20}', '--form-pivot', 'inet:fqdn', '{-> * | limit 20}', '--form-filter', 'inet:fqdn', '{-inet:fqdn:issuffix=1}', '--form-pivot', 'syn:tag', '{-> *}', '--form-pivot', '*', '{-> #}'), kids=[]]]",
    'Query: [ForLoop: [Const: foo, kids=[], VarValue: [Const: foos, kids=[]], SubQuery: [Query: [EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 1.2.3.4, kids=[]], SwitchCase: [VarValue: [Const: foo, kids=[]], CaseEntry: [Const: bar, kids=[], SubQuery: [Query: [EditTagAdd: [TagName: ohai, kids=[]], BreakOper: []]]], CaseEntry: [Const: baz, kids=[], SubQuery: [Query: [EditTagAdd: [TagName: visi, kids=[]], ContinueOper: []]]]], EditNodeAdd: [AbsProp: inet:ipv4, kids=[], Const: 5.6.7.8, kids=[]], EditTagAdd: [TagName: hehe, kids=[]]]]]]',
    'Query: [LiftPropBy: [Const: testint, kids=[], Const: =, kids=[], Const: 1234, kids=[]], EditNodeAdd: [AbsProp: teststr, kids=[], FuncCall: [VarDeref: [VarValue: [Const: node, kids=[]], Const: value, kids=[]], CallArgs: []]], FiltOper: [Const: -, kids=[], HasAbsPropCond: [AbsProp: testint, kids=[]]]]',
    'Query: [LiftPropBy: [Const: testint, kids=[], Const: =, kids=[], Const: 1234, kids=[]], EditNodeAdd: [AbsProp: teststr, kids=[], FuncCall: [VarDeref: [VarValue: [Const: node, kids=[]], Const: form, kids=[]], CallArgs: []]], FiltOper: [Const: -, kids=[], HasAbsPropCond: [AbsProp: testint, kids=[]]]]',
    "Query: [ForLoop: [Const: foo, kids=[], VarValue: [Const: foos, kids=[]], SubQuery: [Query: [VarListSetOper: [VarList: ['fqdn', 'ipv4'], kids=[], FuncCall: [VarDeref: [VarValue: [Const: foo, kids=[]], Const: split, kids=[]], CallArgs: [Const: |, kids=[]]]], EditNodeAdd: [AbsProp: inet:dns:a, kids=[], List: None]]]]]",
    'Query: [EditNodeAdd: [AbsProp: testint, kids=[], VarDeref: [VarValue: [Const: hehe, kids=[]], Const: haha, kids=[]]]]',
    "Query: [VarListSetOper: [VarList: ['tick', 'tock'], kids=[], UnivPropValue: [UnivProp: .seen, kids=[]]]]",
    'Query: [ForLoop: [Const: tag, kids=[], FuncCall: [VarDeref: [VarValue: [Const: node, kids=[]], Const: tags, kids=[]], CallArgs: []], SubQuery: [Query: [FormPivot: [AbsProp: testint, kids=[]], isjoin=False, EditTagAdd: [VarValue: [Const: tag, kids=[]]]]]]]',
    'Query: [ForLoop: [Const: tag, kids=[], FuncCall: [VarDeref: [VarValue: [Const: node, kids=[]], Const: tags, kids=[]], CallArgs: [Const: fo*, kids=[]]], SubQuery: [Query: [FormPivot: [AbsProp: testint, kids=[]], isjoin=False, EditTagDel: [VarValue: [Const: tag, kids=[]]]]]]]',
]

class GrammarTest(s_t_utils.SynTest):

    def test_grammar(self):
        grammar = open('synapse/lib/storm.g').read()

        parser = lark.Lark(grammar, start='query', debug=True)

        for i, query in enumerate(_Queries):
            try:

                parser.parse(query)
                # print(f'{tree.pretty()}\n)')
            except (lark.ParseError, lark.UnexpectedCharacters):
                # print(f'Failure on parsing {{{query}}}')
                raise

    async def test_parser(self):
        self.maxDiff = None
        async with self.getTestCore() as core:

            parseinfo = {
                'stormcmds': {cmd: {} for cmd in core.stormcmds.keys()},
                'modelinfo': core.model.getModelInfo(),
            }
            # import IPython; IPython.embed()
            for i, query in enumerate(_Queries):
                if i < 0:
                    continue
                print(f'{i:3}: {{{query}}}: ', end='')
                if i > 170:
                    # FIXME:  increase as we get more
                    break
                parser = s_syntax2.Parser(parseinfo, query)
                tree = parser.query()

                print(str(tree))
                self.eq(str(tree), _ParseResults[i])

def gen_parse_list():
    import synapse.lib.syntax as s_syntax
    import synapse.lib.coro as s_coro

    t = s_t_utils.SynTest()
    with s_coro.AsyncToSyncCMgr(t.getTestCore) as core:
        parseinfo = {
            'stormcmds': {cmd: {} for cmd in core.stormcmds.keys()},
            'modelinfo': core.model.getModelInfo(),
        }
        retn = []
        for i, query in enumerate(_Queries):
            parser = s_syntax.Parser(parseinfo, query)
            tree = parser.query()
            retn.append(str(tree))
    return retn

